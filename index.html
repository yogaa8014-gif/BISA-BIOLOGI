<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bisa Biologi - Kuis Kelas X</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        /* CSS KUSTOM */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f7fafc;
        }

        /* Latar Belakang Blur Lembut (Untuk Halaman Utama) */
        #main-page {
            background-image: url('https://images.unsplash.com/photo-1577963212871-3312c1a84f59?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80');
            background-size: cover;
            background-position: center;
            transition: filter 0.5s ease-in-out;
            filter: blur(2px); /* Blur lembut */
        }

        /* Container yang di tengah */
        .centered-card {
            max-width: 450px;
            z-index: 10;
        }

        /* Animasi Transisi Halaman (Opsional - Perlu JavaScript untuk memicu) */
        .page-transition {
            transition: opacity 0.5s ease-in-out;
        }

        /* Gaya untuk tombol opsi kuis */
        .option-btn {
            text-align: left;
            white-space: normal;
            transition: background-color 0.2s, border-color 0.2s, color 0.2s, transform 0.1s;
        }
        .option-btn:hover {
            transform: scale(1.01);
        }
        .selected {
            background-color: #3b82f6 !important; /* Biru Tailwind */
            color: white !important;
            border-color: #3b82f6 !important;
        }
    </style>
</head>
<body class="min-h-screen">
    
    <audio id="bg-audio" loop>
        </audio>

    <div id="app-container">
        
        <div id="main-page" class="page-transition min-h-screen flex items-center justify-center relative p-4">
            <div class="absolute inset-0 bg-black opacity-40"></div> <div class="centered-card bg-white p-6 rounded-xl shadow-2xl relative">
                <h1 class="text-3xl font-bold text-center mb-6 text-green-700">Bisa Biologi üß¨</h1>
                <p class="text-center text-gray-600 mb-4">Uji pengetahuan Biologi Kelas X Anda!</p>
                
                <form id="data-form">
                    <div class="mb-4">
                        <label for="nama" class="block text-sm font-medium text-gray-700">Nama Lengkap</label>
                        <input type="text" class="form-control mt-1 p-2 w-full border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500" id="nama" required>
                    </div>
                    <div class="mb-4">
                        <label for="kelas" class="block text-sm font-medium text-gray-700">Kelas</label>
                        <input type="text" class="form-control mt-1 p-2 w-full border border-gray-300 rounded-lg" id="kelas" required>
                    </div>
                    <div class="mb-6">
                        <label for="absen" class="block text-sm font-medium text-gray-700">Nomor Absen</label>
                        <input type="number" class="form-control mt-1 p-2 w-full border border-gray-300 rounded-lg" id="absen" required>
                    </div>
                    
                    <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 rounded-xl transition duration-300 transform hover:scale-[1.01]" id="start-btn">
                        Mulai Kuis
                    </button>
                    <p id="alert-message" class="text-red-500 text-sm mt-3 text-center hidden">Semua kolom wajib diisi!</p>
                </form>
            </div>
        </div>

        <div id="chapter-page" class="page-transition min-h-screen p-8 hidden bg-gray-50">
            <div class="container mx-auto">
                <h2 class="text-4xl font-extrabold text-center mb-3 text-blue-700">Kuis Biologi Kelas X</h2>
                <p class="text-center text-lg text-gray-600 mb-8" id="user-info"></p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="chapter-list">
                    </div>

                <button id="logout-btn" class="mt-10 mx-auto block text-sm text-gray-500 hover:text-red-500 transition">‚Üê Ganti Data Diri</button>
            </div>
        </div>

        <div id="quiz-page" class="page-transition min-h-screen p-8 hidden bg-gray-100">
            <div class="container mx-auto max-w-2xl">
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-semibold mb-4 text-blue-600" id="chapter-title"></h3>
                    <div class="flex justify-between items-center mb-4 border-b pb-3">
                        <span class="text-lg font-medium text-gray-700" id="question-counter">Soal 1/20</span>
                        <span class="text-lg font-bold text-green-600">Skor: <span id="current-score-display">0</span></span>
                    </div>

                    <div id="quiz-area">
                        <p class="text-2xl font-semibold mb-6 text-gray-800" id="question-text"></p>
                        
                        <div id="options-area" class="d-grid gap-3">
                            </div>
                        
                        <p id="feedback" class="mt-4 text-center font-medium"></p>
                        
                        <button id="submit-btn" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 rounded-lg mt-6 transition duration-300" disabled>
                            Jawab
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // === 1. DATA PERTANYAAN ===
        const QUIZ_DATA = {
            "BAB 1 VIRUS": [
                {
                    question: "Struktur dasar virus yang terdiri dari asam nukleat (DNA/RNA) dan selubung protein disebut...",
                    options: ["Kapsid", "Kapsomer", "Virion", "Bakteriofag"],
                    answer: "Virion"
                },
                {
                    question: "Materi genetik yang dapat dimiliki oleh virus adalah...",
                    options: ["Hanya DNA", "Hanya RNA", "DNA atau RNA", "Protein dan Lipid"],
                    answer: "DNA atau RNA"
                },
                // Placeholder 18 soal lagi
            ].concat(Array(18).fill(null).map((_, i) => ({
                question: `(P${i+3}) Soal VIRUS: Apa fungsi asam nukleat pada virus?`,
                options: ["Sebagai selubung", "Untuk bergerak", "Pembawa informasi genetik", "Untuk melekat"],
                answer: "Pembawa informasi genetik"
            }))),
            
            "BAB 2 KLASIFIKASI MAKHLUK HIDUP": [
                {
                    question: "Tokoh yang memperkenalkan sistem klasifikasi lima kingdom adalah...",
                    options: ["Carolus Linnaeus", "Robert Hooke", "R.H. Whittaker", "Ernst Haeckel"],
                    answer: "R.H. Whittaker"
                },
                {
                    question: "Urutan taksonomi dari yang tertinggi hingga terendah adalah...",
                    options: ["Filum, Kelas, Ordo, Famili, Genus, Spesies", "Spesies, Genus, Famili, Ordo, Kelas, Filum", "Kelas, Filum, Ordo, Famili, Genus, Spesies", "Filum, Kelas, Famili, Ordo, Genus, Spesies"],
                    answer: "Filum, Kelas, Ordo, Famili, Genus, Spesies"
                },
                // Placeholder 18 soal lagi
            ].concat(Array(18).fill(null).map((_, i) => ({
                question: `(P${i+3}) Soal KLASIFIKASI: Nama ilmiah padi adalah Oryza sativa. Kata 'sativa' menunjukkan tingkat taksonomi...`,
                options: ["Genus", "Famili", "Spesies", "Ordo"],
                answer: "Spesies"
            }))),

            "BAB 3 EKOSISTEM PERUBAHAN DAN PELESTARIAN LINGKUNGAN": [
                {
                    question: "Peningkatan kadar karbon dioksida di atmosfer menyebabkan fenomena...",
                    options: ["Hujan Asam", "Eutrofikasi", "Efek Rumah Kaca", "El Nino"],
                    answer: "Efek Rumah Kaca"
                },
                {
                    question: "Komponen yang berperan sebagai pengurai (dekomposer) dalam rantai makanan adalah...",
                    options: ["Produsen", "Herbivora", "Bakteri dan Jamur", "Karnivora"],
                    answer: "Bakteri dan Jamur"
                },
                // Placeholder 18 soal lagi
            ].concat(Array(18).fill(null).map((_, i) => ({
                question: `(P${i+3}) Soal EKOSISTEM: Apa yang dimaksud dengan suksesi primer?`,
                options: ["Perubahan lambat", "Dimulai dari lingkungan rusak", "Dimulai dari lahan tanpa kehidupan", "Populasi berkurang"],
                answer: "Dimulai dari lahan tanpa kehidupan"
            }))),
            
            "BAB 4 BIOTEKNOLOGI": [
                {
                    question: "Bioteknologi yang memanfaatkan mikroorganisme untuk menghasilkan produk tanpa modifikasi genetik disebut...",
                    options: ["Bioteknologi Modern", "Kultur Jaringan", "Bioteknologi Konvensional", "Rekayasa Genetika"],
                    answer: "Bioteknologi Konvensional"
                },
                {
                    question: "Produk bioteknologi modern yang digunakan dalam pengobatan diabetes adalah...",
                    options: ["Tempe", "Yogurt", "Insulin", "Antibiotik"],
                    answer: "Insulin"
                },
                // Placeholder 18 soal lagi
            ].concat(Array(18).fill(null).map((_, i) => ({
                question: `(P${i+3}) Soal BIOTEKNOLOGI: Peran plasmid dalam rekayasa genetika adalah sebagai...`,
                options: ["Enzim", "Vektor", "Sel inang", "DNA target"],
                answer: "Vektor"
            }))),
        };

        // === 2. VARIABEL GLOBAL ===
        const TOTAL_SOAL = 20;
        const POIN_PER_SOAL = 5; // 20 * 5 = 100
        
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedAnswer = null;
        let currentChapter = '';

        // === 3. FUNGSI NAVIGASI ===
        const pages = {
            main: document.getElementById('main-page'),
            chapter: document.getElementById('chapter-page'),
            quiz: document.getElementById('quiz-page')
        };

        function showPage(targetPageId) {
            const pageElements = Object.values(pages);
            pageElements.forEach(page => {
                page.classList.add('opacity-0');
                setTimeout(() => {
                    page.classList.add('hidden');
                }, 500); // Tunggu sampai transisi opacity selesai
            });

            const targetPage = pages[targetPageId];
            if (targetPage) {
                setTimeout(() => {
                    targetPage.classList.remove('hidden');
                    targetPage.classList.remove('opacity-0');
                    // Atur background halaman utama blur hanya saat di halaman utama
                    if (targetPageId === 'main') {
                        document.body.classList.add('min-h-screen');
                        document.getElementById('main-page').style.filter = 'blur(2px)';
                    } else {
                        document.getElementById('main-page').style.filter = 'none';
                        document.body.classList.remove('min-h-screen');
                    }
                }, 10); // Sedikit jeda untuk memastikan class hidden terhapus sebelum transisi
            }
        }

        // === 4. HALAMAN UTAMA (main-page) LOGIC ===
        document.getElementById('data-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const nama = document.getElementById('nama').value.trim();
            const kelas = document.getElementById('kelas').value.trim();
            const absen = document.getElementById('absen').value.trim();
            const alertMessage = document.getElementById('alert-message');

            if (nama && kelas && absen) {
                // Simpan data pemain ke LocalStorage
                localStorage.setItem('kuisDataPemain', JSON.stringify({
                    nama: nama,
                    kelas: kelas,
                    absen: absen
                }));
                alertMessage.classList.add('hidden');
                
                // Pindah ke halaman pemilihan bab
                renderChapterList();
                showPage('chapter');
            } else {
                alertMessage.classList.remove('hidden');
            }
        });

        // Event listener untuk tombol "Ganti Data Diri" di halaman bab
        if (document.getElementById('logout-btn')) {
            document.getElementById('logout-btn').addEventListener('click', () => {
                localStorage.removeItem('kuisDataPemain');
                showPage('main');
            });
        }


        // === 5. HALAMAN PEMILIHAN BAB (chapter-page) LOGIC ===
        function renderChapterList() {
            const chapterListDiv = document.getElementById('chapter-list');
            const userData = JSON.parse(localStorage.getItem('kuisDataPemain'));
            
            if (!userData) {
                showPage('main');
                return;
            }

            document.getElementById('user-info').textContent = 
                `${userData.nama} | ${userData.kelas} / Absen ${userData.absen}`;

            chapterListDiv.innerHTML = '';
            
            Object.keys(QUIZ_DATA).forEach(chapterName => {
                const totalSoal = QUIZ_DATA[chapterName].length;
                
                const cardHtml = `
                    <div class="col-span-1">
                        <div class="bg-white p-5 rounded-lg shadow-md hover:shadow-xl transition duration-300 transform hover:scale-[1.03] flex flex-col h-full">
                            <h5 class="text-xl font-bold text-gray-800 mb-2">${chapterName}</h5>
                            <p class="text-gray-500 mb-4">${totalSoal} Soal | Poin Maks: 100</p>
                            <button class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 rounded-lg mt-auto start-quiz-btn" data-chapter="${chapterName}">
                                Mulai Kuis
                            </button>
                        </div>
                    </div>
                `;
                chapterListDiv.innerHTML += cardHtml;
            });
            
            document.querySelectorAll('.start-quiz-btn').forEach(button => {
                button.addEventListener('click', function() {
                    currentChapter = this.getAttribute('data-chapter');
                    localStorage.setItem('kuisCurrentChapter', currentChapter);
                    
                    // Reset kuis state
                    currentQuestionIndex = 0;
                    score = 0;
                    localStorage.removeItem('kuisCurrentScore'); 
                    localStorage.removeItem('kuisCurrentIndex'); 

                    startQuiz();
                });
            });
        }


        // === 6. LOGIKA KUIS (quiz-page) ===
        function startQuiz() {
            if (!currentChapter) {
                currentChapter = localStorage.getItem('kuisCurrentChapter');
            }

            if (!currentChapter || !QUIZ_DATA[currentChapter]) {
                alert("Pilih bab terlebih dahulu!");
                showPage('chapter');
                return;
            }
            
            document.getElementById('chapter-title').textContent = currentChapter;
            document.getElementById('current-score-display').textContent = score;

            // Pastikan event listener untuk Jawab/Lanjut dipasang dengan benar
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.removeEventListener('click', nextQuestion);
            submitBtn.addEventListener('click', checkAnswer);

            loadQuestion();
            showPage('quiz');
        }

        function loadQuestion() {
            const questions = QUIZ_DATA[currentChapter];

            if (currentQuestionIndex < questions.length) {
                const currentQ = questions[currentQuestionIndex];
                
                document.getElementById('question-counter').textContent = `Soal ${currentQuestionIndex + 1}/${questions.length}`;
                document.getElementById('question-text').textContent = currentQ.question;
                const optionsArea = document.getElementById('options-area');
                const submitBtn = document.getElementById('submit-btn');
                const feedback = document.getElementById('feedback');

                optionsArea.innerHTML = ''; 
                selectedAnswer = null;
                submitBtn.disabled = true;
                feedback.textContent = '';
                
                submitBtn.textContent = 'Jawab';
                submitBtn.classList.remove('bg-yellow-500');
                submitBtn.classList.add('bg-blue-500');


                // Buat Pilihan Jawaban
                currentQ.options.forEach(option => {
                    const button = document.createElement('button');
                    button.textContent = option;
                    // Menggunakan utilitas Bootstrap dan Tailwind untuk styling
                    button.classList.add('btn', 'btn-outline-primary', 'option-btn', 'hover:bg-blue-50'); 
                    button.addEventListener('click', () => selectAnswer(option, button));
                    optionsArea.appendChild(button);
                });

            } else {
                // Kuis Selesai
                displayResult();
            }
        }

        function selectAnswer(option, button) {
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.classList.remove('selected', 'btn-primary');
                btn.classList.add('btn-outline-primary');
            });

            button.classList.remove('btn-outline-primary');
            button.classList.add('selected');
            selectedAnswer = option;
            document.getElementById('submit-btn').disabled = false;
        }

        function checkAnswer() {
            if (!selectedAnswer) return;

            const currentQ = QUIZ_DATA[currentChapter][currentQuestionIndex];
            const optionButtons = document.querySelectorAll('.option-btn');
            const feedback = document.getElementById('feedback');
            const submitBtn = document.getElementById('submit-btn');
            
            optionButtons.forEach(btn => btn.disabled = true);

            if (selectedAnswer === currentQ.answer) {
                score += POIN_PER_SOAL; 
                feedback.textContent = "‚úÖ Benar! Anda mendapat 5 poin.";
                feedback.className = 'mt-4 text-center font-medium text-green-600';

            } else {
                feedback.textContent = `‚ùå Salah. Jawaban yang benar adalah: ${currentQ.answer}`;
                feedback.className = 'mt-4 text-center font-medium text-red-600';
            }
            
            document.getElementById('current-score-display').textContent = score;

            // Tampilkan visual jawaban
            optionButtons.forEach(btn => {
                btn.classList.remove('selected', 'btn-primary', 'btn-outline-primary', 'hover:bg-blue-50'); 
                
                if (btn.textContent === currentQ.answer) {
                    btn.classList.add('btn-success');
                } else if (btn.textContent === selectedAnswer) {
                    btn.classList.add('btn-danger');
                } else {
                    btn.classList.add('btn-secondary');
                }
            });

            // Simpan status kuis
            localStorage.setItem('kuisCurrentScore', score);
            localStorage.setItem('kuisCurrentIndex', currentQuestionIndex + 1);
            
            submitBtn.textContent = 'Lanjut';
            submitBtn.removeEventListener('click', checkAnswer);
            submitBtn.addEventListener('click', nextQuestion);
            submitBtn.classList.remove('bg-blue-500', 'hover:bg-blue-600');
            submitBtn.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
            submitBtn.disabled = false; 
        }

        function nextQuestion() {
            currentQuestionIndex++;
            
            const submitBtn = document.getElementById('submit-btn');
            submitBtn.removeEventListener('click', nextQuestion);
            submitBtn.addEventListener('click', checkAnswer);
            
            loadQuestion();
        }

        // === 7. HALAMAN HASIL (sweetalert2) LOGIC ===
        function displayResult() {
            const finalScore = parseInt(localStorage.getItem('kuisCurrentScore')) || 0;
            const userData = JSON.parse(localStorage.getItem('kuisDataPemain'));
            
            let titleText;
            let iconType;
            let htmlContent;

            if (finalScore === 100) {
                titleText = 'Skor Sempurna! üéâ';
                iconType = 'success';
                htmlContent = `
                    <h2 class="text-3xl font-bold text-green-600 mb-2">SELAMAT!</h2>
                    <p class="text-xl">Anda mendapatkan nilai <span class="font-extrabold">${finalScore}</span>. Luar Biasa!</p>
                    <p class="text-md text-gray-500 mt-2">${userData.nama}, Anda menguasai bab ${currentChapter}.</p>
                `;
            } else if (finalScore < 75) {
                titleText = 'Coba Lagi üò•';
                iconType = 'error';
                htmlContent = `
                    <h2 class="text-3xl font-bold text-red-600 mb-2">Semangat!</h2>
                    <p class="text-xl">Nilai Anda hanya <span class="font-extrabold">${finalScore}</span>.</p>
                    <p class="text-md text-gray-500 mt-2">Pelajari kembali bab ${currentChapter} dan coba lagi!</p>
                    

[Image of Try Again]

                `;
            } else {
                titleText = 'Hasil Kuis üëè';
                iconType = 'info';
                htmlContent = `
                    <h2 class="text-3xl font-bold text-blue-600 mb-2">Bagus Sekali!</h2>
                    <p class="text-xl">Anda mendapatkan nilai <span class="font-extrabold">${finalScore}</span>.</p>
                    <p class="text-md text-gray-500 mt-2">Sedikit lagi menuju nilai sempurna!</p>
                `;
            }

            // Tampilkan pop-up hasil
            Swal.fire({
                title: titleText,
                html: htmlContent,
                icon: iconType,
                confirmButtonText: 'Kembali ke Pemilihan Bab',
                allowOutsideClick: false,
                backdrop: true
            }).then(() => {
                // Bersihkan LocalStorage
                localStorage.removeItem('kuisCurrentScore');
                localStorage.removeItem('kuisCurrentIndex');
                localStorage.removeItem('kuisCurrentChapter');
                currentChapter = '';
                currentQuestionIndex = 0;
                score = 0;
                // Kembali ke halaman pemilihan bab
                renderChapterList();
                showPage('chapter');
            });
        }
        
        // === 8. INIASIALISASI APLIKASI ===
        document.addEventListener('DOMContentLoaded', () => {
            const userData = localStorage.getItem('kuisDataPemain');
            
            if (userData) {
                // Jika data pemain sudah ada, langsung ke halaman pemilihan bab
                renderChapterList();
                showPage('chapter');
            } else {
                // Jika belum ada, tampilkan halaman utama
                showPage('main');
            }

            // Inisialisasi Audio (Opsional - Perlu penyesuaian file path)
            const audio = document.getElementById('bg-audio');
            if (audio) {
                audio.volume = 0.1; // Volume rendah
                // Anda mungkin perlu pemicu user action untuk memutar audio
                // audio.play().catch(e => console.log("Audio play failed:", e));
            }
        });
    </script>
</body>
</html>
